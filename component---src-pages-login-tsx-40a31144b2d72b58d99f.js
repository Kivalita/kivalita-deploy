(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{Hj9l:function(e,t){e.exports={BaseUrl:"https://kivalitaapi.azurewebsites.net/api/"}},OgpL:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var r=n("o0o1"),a=n.n(r),o=(n("ls82"),n("HaE+")),s=n("q1tI"),i=n.n(s),u=n("Sytq"),c=n("UIH6"),f=function(){function e(){this.api=new u.a}var t=e.prototype;return t.login=function(e,t){return this.api.post("user/auth",{email:e,password:t,grantType:"password"}).then((function(e){var t=e.accessToken,n=e.refreshToken,r=e.user;return c.a.storeToken(t),c.a.storeRefreshToken(n),c.a.storeUser(r),e}))},t.logout=function(){c.a.clearToken()},e}(),l=Object(s.createContext)({}),p=function(e){var t=e.children,n=Object(s.useState)((function(){var e=c.a.getToken(),t=c.a.getUser();return e&&t?{accessToken:e,user:t}:{}})),r=n[0],u=n[1],p=Object(s.useCallback)(function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,o,s,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=t.password,o=new f,e.next=4,o.login(n,r);case 4:s=e.sent,i=s.accessToken,c=s.user,u({accessToken:i,user:c});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),d=Object(s.useCallback)((function(){c.a.clearToken(),u({})}),[]);return i.a.createElement(l.Provider,{value:{user:r.user,signIn:p,signOut:d}},t)};function d(){var e=Object(s.useContext)(l);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}},Sytq:function(e,t,n){"use strict";var r=n("o0o1"),a=n.n(r),o=(n("ls82"),n("HaE+")),s=n("vDqi"),i=n.n(s),u=n("UIH6"),c=n("Hj9l"),f=function(){function e(){var e=this;this.isRefreshing=!1,this.refreshSubscribers=[],this.api=i.a.create({baseURL:c.BaseUrl}),this.api.interceptors.request.use((function(e){return e.headers.Authorization="Bearer "+u.a.getToken(),e})),this.api.interceptors.response.use((function(e){return e}),(function(t){var n;return 401!==(null===(n=t.response)||void 0===n?void 0:n.status)?new Promise((function(e,n){n(t)})):e.getNewToken().then((function(e){var n=t.config;return n.headers.Authorization="Bearer "+e,new Promise((function(e,t){i.a.request(n).then((function(t){e(t)})).catch((function(e){t(e)}))}))})).catch((function(e){Promise.reject(e)}))}))}var t=e.prototype;return t.getNewToken=function(){var e={accessToken:"",expirationDate:"",refreshToken:u.a.getRefreshToken()||"",Email:"",Password:"",GrantType:"refresh_token"};return this.post("User/auth",e,{}).then((function(e){return u.a.storeToken(e.accessToken),u.a.storeRefreshToken(e.refreshToken),e.accessToken}))},t.get=function(){var e=Object(o.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get(t,{headers:n}).then((function(e){if(e.data.isStatusCodeSuccess)return e.data.data;throw e.data.errorMessage}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.put=function(){var e=Object(o.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.put(t,n,{headers:r}).then((function(e){if(e.data.isStatusCodeSuccess)return e.data.data;throw e.data.errorMessage}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.post=function(){var e=Object(o.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.post(t,n,{headers:r}).then((function(e){if(e.data.isStatusCodeSuccess)return e.data.data;throw e.data.errorMessage}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.delete=function(){var e=Object(o.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.delete(t,{headers:n}).then((function(e){if(e.data.isStatusCodeSuccess)return e.data.data;throw e.data.errorMessage}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e}();t.a=f},UIH6:function(e,t,n){"use strict";var r=function(){function e(){}return e.clearToken=function(){"undefined"!=typeof localStorage&&(localStorage.removeItem(this.LOCAL_STORAGE_USER),localStorage.removeItem(this.LOCAL_STORAGE_TOKEN),localStorage.removeItem(this.LOCAL_STORAGE_REFRESH_TOKEN))},e.storeUser=function(e){"undefined"!=typeof localStorage&&localStorage.setItem(this.LOCAL_STORAGE_USER,JSON.stringify(e))},e.storeToken=function(e){"undefined"!=typeof localStorage&&localStorage.setItem(this.LOCAL_STORAGE_TOKEN,e)},e.storeRefreshToken=function(e){"undefined"!=typeof localStorage&&localStorage.setItem(this.LOCAL_STORAGE_REFRESH_TOKEN,e)},e.getRefreshToken=function(){if("undefined"!=typeof localStorage)return localStorage.getItem(this.LOCAL_STORAGE_REFRESH_TOKEN)},e.getToken=function(){if("undefined"!=typeof localStorage)return localStorage.getItem(this.LOCAL_STORAGE_TOKEN)},e.getUser=function(){if("undefined"!=typeof localStorage){var e=localStorage.getItem(this.LOCAL_STORAGE_USER);return JSON.parse(e)}},e}();r.LOCAL_STORAGE_USER="user",r.LOCAL_STORAGE_TOKEN="token",r.LOCAL_STORAGE_REFRESH_TOKEN="refresh_token",t.a=r},jRni:function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),a=n.n(r),o=n("o0o1"),s=n.n(o),i=(n("ls82"),n("HaE+")),u=n("Wbzz"),c=n("OgpL"),f=n("vOnD"),l=f.b.section.withConfig({componentId:"sc-4zpro5-0"})(["height:100vh;display:flex;align-items:stretch;"]),p=f.b.section.withConfig({componentId:"sc-4zpro5-1"})(["display:flex;flex-direction:column;align-items:center;place-content:center;width:100%;max-width:700px;form{width:100%;max-width:340px;input{background:#232129;border-radius:10px;border:2px solid #232129;padding:16px;width:100%;color:#f4ede8;flex:1;border:0;display:flex;align-items:center;& + input{margin-top:8px;}&::placeholder{color:#666360;}}button{background:#13414f;height:56px;border-radius:10px;border:0;outline:0;padding:0 16px;color:#fff;width:100%;font-weight:500;margin-top:16px;transition:background-color 0.2s;}img{margin-bottom:80px;}}"]),d=f.b.section.withConfig({componentId:"sc-4zpro5-2"})(['flex:1;background:url("https://www.kivalitaconsulting.com/wp-content/uploads/2019/06/leao-sobre-21-2-1.png") no-repeat center;background-position:120px 140px;background-color:#13414f;background-size:initial;']),h=n("pZBt"),g=n.n(h),b=n("t26L"),m=function(){var e=Object(b.a)(),t=e.value,n=e.bind,r=(e.reset,Object(b.a)()),o=r.value,f=r.bind,h=(r.reset,Object(c.b)().signIn);function m(){return(m=Object(i.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),!t||!o){e.next=11;break}return e.prev=2,e.next=5,h({email:t,password:o});case 5:Object(u.navigate)("/"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),alert("Erro ao fazer login");case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}return a.a.createElement(l,null,a.a.createElement(p,null,a.a.createElement("form",{onSubmit:function(e){return m.apply(this,arguments)}},a.a.createElement("img",{src:g.a,alt:"Logo Kivalita"}),a.a.createElement("input",Object.assign({type:"text",placeholder:"E-mail"},n)),a.a.createElement("input",Object.assign({type:"password",placeholder:"Senha"},f)),a.a.createElement("button",null,"Entrar"))),a.a.createElement(d,null))};t.default=function(){return a.a.createElement(c.a,null,a.a.createElement(m,null))}},t26L:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("q1tI"),a=function(e){void 0===e&&(e="");var t=Object(r.useState)(e),n=t[0],a=t[1];return{value:n,setValue:a,reset:function(){return a("")},bind:{value:n,onChange:function(e){a("string"==typeof e?e:e.target.value)}}}}}}]);
//# sourceMappingURL=component---src-pages-login-tsx-40a31144b2d72b58d99f.js.map